/n/fs/nlp-saml/miniconda3/envs/racoln/lib/python3.7/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
2022-05-02 23:56:34 | INFO | train_tsf_model.py | [Iteration 100] SelfLoss : 4.674 CycleLoss : 0 StyleLoss : 0.041 ContentLoss : 0.085
2022-05-02 23:56:39 | INFO | train_tsf_model.py | [Iteration 100] Model Checkpoint Saved with Loss : 4.744, Acc : 78.5, BLEU : 2.805
2022-05-02 23:57:03 | INFO | train_tsf_model.py | [Iteration 200] SelfLoss : 3.989 CycleLoss : 0 StyleLoss : 0.031 ContentLoss : 0.096
2022-05-02 23:57:07 | INFO | train_tsf_model.py | [Iteration 200] Model Checkpoint Saved with Loss : 4.121, Acc : 79.3, BLEU : 4.112
Traceback (most recent call last):
  File "train_tsf_model.py", line 137, in <module>
    loss, accuracy, bleu_scores= getLossAndMetrics(dev_iter,G, dec, nll, enc_r, attn_r, senti_r, BCE, mse, config, pad_idx, enc_cls, attn_cls, senti_cls, len(dev), X_VOCAB, C_LABEL)
  File "/n/fs/nlp-saml/RACoLN_cycleloss/src/util.py", line 166, in getLossAndMetrics
    self_loss, hidden_self = computeSelfLoss(batch, G, dec, nll)
  File "/n/fs/nlp-saml/RACoLN_cycleloss/src/util.py", line 124, in computeSelfLoss
    decoder_outputs, decoder_hidden, ret_dict = dec(None, hidden_self.unsqueeze(0), output_selt, mask = src_mask, attn_hidden = attn_hidden_self, label=batch.C, gumbel = False, max_length = max_len)
  File "/n/fs/nlp-saml/miniconda3/envs/racoln/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/n/fs/nlp-saml/RACoLN_cycleloss/src/model.py", line 223, in forward
    lengths = np.array([max_length] * batch_size)
  File "/n/fs/nlp-saml/miniconda3/envs/racoln/lib/python3.7/site-packages/torch/_tensor.py", line 639, in __array__
    def __array__(self, dtype=None):
KeyboardInterrupt
2022-05-02 23:57:31 | INFO | train_tsf_model.py | [Iteration 300] SelfLoss : 3.636 CycleLoss : 0 StyleLoss : 0.034 ContentLoss : 0.114